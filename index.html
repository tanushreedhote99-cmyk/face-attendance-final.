<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>AI Face Attendance Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { background: #0f172a; color: white; font-family: sans-serif; }
        .camera-section { border: 4px solid #1e293b; border-radius: 15px; overflow: hidden; background: #000; min-height: 400px; display: flex; align-items: center; justify-content: center; }
        .stats-card { background: #1e293b; border-radius: 12px; padding: 20px; border-left: 5px solid #3b82f6; margin-bottom: 10px; }
        .value { font-size: 1.4rem; font-weight: bold; font-family: 'Orbitron', sans-serif; }
    </style>
</head>
<body>
<div class="container mt-4">
    <h2 class="text-center mb-4" style="font-family: 'Orbitron';">CODELINE.AI DASHBOARD</h2>
    <div class="row">
        <div class="col-md-8">
            <div class="camera-section">
                <img src="{{ url_for('video_feed') }}" id="feed" style="width:100%;">
                <h1 id="msg" style="display:none; color:#22c55e;">âœ… ATTENDANCE DONE</h1>
            </div>
        </div>
        <div class="col-md-4">
            <div class="stats-card"><div>Name</div><div id="name" class="value">Scanning...</div></div>
            <div class="stats-card"><div>Time</div><div id="time" class="value">--:--:--</div></div>
            <div class="stats-card"><div>Date</div><div id="date" class="value">--/--/----</div></div>
        </div>
    </div>
</div>

<script>
    let checkStatus = setInterval(function() {
        fetch('/get_data')
            .then(r => r.json())
            .then(data => {
                document.getElementById('name').innerText = data.name;
                document.getElementById('time').innerText = data.time;
                document.getElementById('date').innerText = data.date;

                if (data.status === "Done") {
                    document.getElementById('feed').src = ""; // Clear Image
                    document.getElementById('feed').style.display = "none"; // Hide Image
                    document.getElementById('msg').style.display = "block"; // Show Success Text
                    window.stop(); // BROWSER DATA FETCH STOP KAREGA
                    clearInterval(checkStatus); // SCRIPT STOP KAREGI
                }
            });
    }, 1000);
</script>
</body>
</html>